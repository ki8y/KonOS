:: Disabling intel bloat (thanks Sora!)
color 9
cls && echo Disabling Intel Services...
for %%D in (
    dptftcs
    igccservice
    IntelDisplayUMService
    ipfsvc
    WMIRegistrationService
) do (
    echo ðŸ›ˆ Disabling %%D...
    sc config %%D start= disabled >nul 2>&1
)
echo [92mâœ“ Done.[39m

:: Disabling HP Services (thanks again Sora!)
echo Disabling HP services...
for %%D in (
    HPNetworkCap
    HPOmenCap
    HPSysInfoCap
    HpTouchpointAnalyticsService
    HPAppHelperCap
    HPAudioAnalytics
    HPDiagsCap
    HotKeyServiceUWP
    LanWlanWwanSwitchingServiceUWP
    hpsvcsscan
    SFUService
) do (
    echo ðŸ›ˆ Disabling %%D...
    sc config %%D start= disabled >nul 2>&1
)
echo [92mâœ“ Done.

setlocal enabledelayedexpansion
chcp 437 >nul
PowerShell -ExecutionPolicy Unrestricted -NoProfile -File "%~dp0Modules\Scripts\peskyServices.ps1"
chcp 65001 >nul
endlocal

:: ============Privacy is freedom's service control============
:: Credits (YouTube): https://www.youtube.com/@PrivacyisFreedom
:: Credits (Github): https://github.com/PrivacyIsFreedom
echo ðŸ›ˆ Disabling PimIndexMaintenanceSvc...
reg add "HKLM\System\CurrentControlSet\Services\PimIndexMaintenanceSvc" /v "Start" /t REG_DWORD /d "4" /f >nul 2>&1
echo ðŸ›ˆ Disabling WinHttpAutoProxySvc...
reg add "HKLM\System\CurrentControlSet\Services\WinHttpAutoProxySvc" /v "Start" /t REG_DWORD /d "4" /f >nul 2>&1
echo ðŸ›ˆ Disabling BcastDVRUserService...
reg add "HKLM\System\CurrentControlSet\Services\BcastDVRUserService" /v "Start" /t REG_DWORD /d "4" /f >nul 2>&1
echo ðŸ›ˆ Disabling xbgm...
reg add "HKLM\System\CurrentControlSet\Services\xbgm" /v "Start" /t REG_DWORD /d "4" /f >nul 2>&1
echo ðŸ›ˆ Disabling GameDVR video capture...
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\GameDVR" /v "AppCaptureEnabled" /t REG_DWORD /d "0" /f >nul 2>&1
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\GameDVR" /v "AudioCaptureEnabled" /t REG_DWORD /d "0" /f >nul 2>&1
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\GameDVR" /v "CursorCaptureEnabled" /t REG_DWORD /d "0" /f >nul 2>&1
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\GameDVR" /v "MicrophoneCaptureEnabled" /t REG_DWORD /d "0" /f >nul 2>&1
echo ðŸ›ˆ Enabling exclusive fullscreen...
reg add "HKCU\System\GameConfigStore" /v "GameDVR_FSEBehavior" /t REG_DWORD /d "2" /f >nul 2>&1
echo ðŸ›ˆ Forcing exclusive fullscreen...
reg add "HKCU\System\GameConfigStore" /v "GameDVR_HonorUserFSEBehaviorMode" /t REG_DWORD /d "2" /f >nul 2>&1
echo ðŸ›ˆ Disabling GameDVR globally...
reg add "HKCU\System\GameConfigStore" /v "GameDVR_Enabled" /t REG_DWORD /d "0" /f >nul 2>&1
reg add "HKLM\Software\Policies\Microsoft\Windows\GameDVR" /v "AllowgameDVR" /t REG_DWORD /d "0" /f >nul 2>&1
:: The reason we disable game mode is because it can cause inconsistency in performance; especially on intel cpu's.
echo ðŸ›ˆ Disabling Game Mode
reg add "HKCU\Software\Microsoft\GameBar" /v "AutoGameModeEnabled" /t REG_DWORD /d "0" /f >nul 2>&1
echo ðŸ›ˆ Disabling OneSyncSvc...
reg add "HKLM\SYSTEM\CurrentControlSet\Services\OneSyncSvc" /v "Start" /t REG_DWORD /d "4" /f >nul 2>&1

echo ðŸ›ˆ Cleaning Task Scheduler...
schtasks /DELETE /TN "AMDInstallLauncher" /f
schtasks /DELETE /TN "AMDLinkUpdate" /f
schtasks /DELETE /TN "AMDRyzenMasterSDKTask" /f
schtasks /DELETE /TN "Driver Easy Scheduled Scan" /f
schtasks /DELETE /TN "ModifyLinkUpdate" /f
schtasks /DELETE /TN "SoftMakerUpdater" /f
schtasks /DELETE /TN "StartCN" /f
schtasks /DELETE /TN "StartDVR" /f
schtasks /Change /TN "Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser" /Disable
schtasks /Change /TN "Microsoft\Windows\Application Experience\PcaPatchDbTask" /Disable
schtasks /Change /TN "Microsoft\Windows\Application Experience\ProgramDataUpdater" /Disable
schtasks /Change /TN "Microsoft\Windows\Application Experience\StartupAppTask" /Disable
schtasks /Change /TN "Microsoft\Windows\Autochk\Proxy" /Disable
schtasks /Change /TN "Microsoft\Windows\Customer Experience Improvement Program\Consolidator" /Disable
schtasks /Change /TN "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip" /Disable
schtasks /Change /TN "Microsoft\Windows\Defrag\ScheduledDefrag" /Disable
schtasks /Change /TN "Microsoft\Windows\Device Information\Device" /Disable
schtasks /Change /TN "Microsoft\Windows\Device Information\Device User" /Disable
schtasks /Change /TN "Microsoft\Windows\Diagnosis\RecommendedTroubleshootingScanner" /Disable
schtasks /Change /TN "Microsoft\Windows\Diagnosis\Scheduled" /Disable
schtasks /Change /TN "Microsoft\Windows\DiskCleanup\SilentCleanup" /Disable
schtasks /Change /TN "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector" /Disable
schtasks /Change /TN "Microsoft\Windows\DiskFootprint\Diagnostics" /Disable
schtasks /Change /TN "Microsoft\Windows\DiskFootprint\StorageSense" /Disable
schtasks /Change /TN "Microsoft\Windows\DUSM\dusmtask" /Disable
schtasks /Change /TN "Microsoft\Windows\EnterpriseMgmt\MDMMaintenenceTask" /Disable
schtasks /Change /TN "Microsoft\Windows\Feedback\Siuf\DmClient" /Disable
schtasks /Change /TN "Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload" /Disable
schtasks /Change /TN "Microsoft\Windows\FileHistory\File History (maintenance mode)" /Disable
schtasks /Change /TN "Microsoft\Windows\Flighting\FeatureConfig\ReconcileFeatures" /Disable
schtasks /Change /TN "Microsoft\Windows\Flighting\FeatureConfig\UsageDataFlushing" /Disable
schtasks /Change /TN "Microsoft\Windows\Flighting\FeatureConfig\UsageDataReporting" /Disable
schtasks /Change /TN "Microsoft\Windows\Flighting\OneSettings\RefreshCache" /Disable
schtasks /Change /TN "Microsoft\Windows\Input\LocalUserSyncDataAvailable" /Disable
schtasks /Change /TN "Microsoft\Windows\Input\MouseSyncDataAvailable" /Disable
schtasks /Change /TN "Microsoft\Windows\Input\PenSyncDataAvailable" /Disable
schtasks /Change /TN "Microsoft\Windows\Input\TouchpadSyncDataAvailable" /Disable
schtasks /Change /TN "Microsoft\Windows\International\Synchronize Language Settings" /Disable
schtasks /Change /TN "Microsoft\Windows\LanguageComponentsInstaller\Installation" /Disable
schtasks /Change /TN "Microsoft\Windows\LanguageComponentsInstaller\ReconcileLanguageResources" /Disable
schtasks /Change /TN "Microsoft\Windows\LanguageComponentsInstaller\Uninstallation" /Disable
schtasks /Change /TN "Microsoft\Windows\License Manager\TempSignedLicenseExchange" /Disable
schtasks /Change /TN "Microsoft\Windows\Management\Provisioning\Cellular" /Disable
schtasks /Change /TN "Microsoft\Windows\Management\Provisioning\Logon" /Disable
schtasks /Change /TN "Microsoft\Windows\Maintenance\WinSAT" /Disable
schtasks /Change /TN "Microsoft\Windows\Maps\MapsToastTask" /Disable
schtasks /Change /TN "Microsoft\Windows\Maps\MapsUpdateTask" /Disable
schtasks /Change /TN "Microsoft\Windows\Mobile Broadband Accounts\MNO Metadata Parser" /Disable
schtasks /Change /TN "Microsoft\Windows\MUI\LPRemove" /Disable
schtasks /Change /TN "Microsoft\Windows\NetTrace\GatherNetworkInfo" /Disable
schtasks /Change /TN "Microsoft\Windows\PI\Sqm-Tasks" /Disable
schtasks /Change /TN "Microsoft\Windows\Power Efficiency Diagnostics\AnalyzeSystem" /Disable
schtasks /Change /TN "Microsoft\Windows\PushToInstall\Registration" /Disable
schtasks /Change /TN "Microsoft\Windows\Ras\MobilityManager" /Disable
schtasks /Change /TN "Microsoft\Windows\RecoveryEnvironment\VerifyWinRE" /Disable
schtasks /Change /TN "Microsoft\Windows\RemoteAssistance\RemoteAssistanceTask" /Disable
schtasks /Change /TN "Microsoft\Windows\RetailDemo\CleanupOfflineContent" /Disable
schtasks /Change /TN "Microsoft\Windows\Servicing\StartComponentCleanup" /Disable
schtasks /Change /TN "Microsoft\Windows\SettingSync\NetworkStateChangeTask" /Disable
schtasks /Change /TN "Microsoft\Windows\Setup\SetupCleanupTask" /Disable
schtasks /Change /TN "Microsoft\Windows\Setup\SnapshotCleanupTask" /Disable
schtasks /Change /TN "Microsoft\Windows\SpacePort\SpaceAgentTask" /Disable
schtasks /Change /TN "Microsoft\Windows\SpacePort\SpaceManagerTask" /Disable
schtasks /Change /TN "Microsoft\Windows\Speech\SpeechModelDownloadTask" /Disable
schtasks /Change /TN "Microsoft\Windows\Storage Tiers Management\Storage Tiers Management Initialization" /Disable
schtasks /Change /TN "Microsoft\Windows\Sysmain\ResPriStaticDbSync" /Disable
schtasks /Change /TN "Microsoft\Windows\Sysmain\WsSwapAssessmentTask" /Disable
schtasks /Change /TN "Microsoft\Windows\Task Manager\Interactive" /Disable
schtasks /Change /TN "Microsoft\Windows\Time Synchronization\ForceSynchronizeTime" /Disable
schtasks /Change /TN "Microsoft\Windows\Time Synchronization\SynchronizeTime" /Disable
schtasks /Change /TN "Microsoft\Windows\Time Zone\SynchronizeTimeZone" /Disable
schtasks /Change /TN "Microsoft\Windows\TPM\Tpm-HASCertRetr" /Disable
schtasks /Change /TN "Microsoft\Windows\TPM\Tpm-Maintenance" /Disable
schtasks /Change /TN "Microsoft\Windows\UPnP\UPnPHostConfig" /Disable
schtasks /Change /TN "Microsoft\Windows\User Profile Service\HiveUploadTask" /Disable
schtasks /Change /TN "Microsoft\Windows\WDI\ResolutionHost" /Disable
schtasks /Change /TN "Microsoft\Windows\Windows Filtering Platform\BfeOnServiceStartTypeChange" /Disable
schtasks /Change /TN "Microsoft\Windows\WOF\WIM-Hash-Management" /Disable
schtasks /Change /TN "Microsoft\Windows\WOF\WIM-Hash-Validation" /Disable
schtasks /Change /TN "Microsoft\Windows\Work Folders\Work Folders Logon Synchronization" /Disable
schtasks /Change /TN "Microsoft\Windows\Work Folders\Work Folders Maintenance Work" /Disable
schtasks /Change /TN "Microsoft\Windows\Workplace Join\Automatic-Device-Join" /Disable
schtasks /Change /TN "Microsoft\Windows\WwanSvc\NotificationTask" /Disable
schtasks /Change /TN "Microsoft\Windows\WwanSvc\OobeDiscovery" /Disable
schtasks /Change /TN "Microsoft\XblGameSave\XblGameSaveTask" /Disable

cls && echo Disabling unnecessary services...
color 6
timeout /t 1 >nul
for %%D in (
    BcastDVRUserService
    wlidsvc   
    wcncsvc
    DisplayEnhancementService 
    DiagTrack 
    DusmSvc 
    TabletInputService 
    Fax 
    lfsvc 
    AJRouter
    ALG
    Netlogon
    CertPropSvc
    Themes
    DPS
    AssignedAccessManagerSvc
    DialogBlockingService
    NetTcpPortSharing
    PimIndexMaintenanceSvc
    RemoteAccess
    UevAgentService
    WSearch
    VSS
    MapsBroker
    shpamsvc
    ssh-agent
    tzautoupdate
    uhssvc
    MSDTC
    SecurityHealthService
    SysMain
    WdiServiceHost
    WinDefend
    seclogon
    wscsvc
    wisvc
    StorSvc
    NcbService
    WdiSystemHost
    AppReadiness
    XblAuthManager
    PNRPAutoReg
    XblGameSave
    XboxGipSvc
    XboxNetApiSvc
    SCardSvr
    CscService
    WalletService
    icssvc
    fhsvc
    FrameServer
    FrameServerMonitor
    EntAppSvc
    DmEnrollmentSvc
    AxInstSV
    DeviceAssociationService
    TieringEngineService
    TextInputManagementService
    CDPSvc
    DevQueryBroker
    EFS
    FDResPub
    :: Hyper-V
    HvHost
    vmicguestinterface
    vmicheartbeat
    vmickvpexchange
    vmicrdv
    vmicshutdown
    vmictimesync
    vmicvmsession
    vmicvss
    :: Done
    IKEEXT
    InstallService
    MixedRealityOpenXRSvc
    MsKeyboardFilter
    PrintNotify
    RasMan
    RmSvc
    SensorDataService
    SensorService
    SensrSvc
    SessionEnv
    SharedAccess
    StiSvc
    TokenBroker
    UsoSvc
    W32Time
    WebClient
    Wecsvc
    WinRM
    autotimesvc
    dmwappushservice
    edgeupdate
    edgeupdatem
    fdPHost
    smphost
    wercplsupport
    wuauserv
    DispBrokerDesktopSvc
    FontCache
    LanmanServer
    ShellHWDetection
    TermService
    Wcmsvc
    cbdhsvc 
    WpcMonSvc 
    MicrosoftEdgeElevationService 
    diagnosticshub.standardcollector.service 
    PhoneSvc 
    TapiSrv 
    WbioSrvc 
    SEMgrSvc 
    iphlpsvc 
    BthAvctpSvc 
    BDESVC 
    CDPUserSvc 
    DevicesFlowUserSvc 
    TrkWks 
    dLauncherLoopback 
    NPSMSvc 
    WPDBusEnum 
    PcaSvc 
    RetailDemo
    SSDPSRV 
    OneSyncSvc 
    UserDataSvc 
    UnistoreSvc 
    DsSvc 
    AppVClient 
    SstpSvc 
    WMPNetworkSvc 
    WerSvc  
    WinHttpAutoProxySvc 
    DsmSvc 
    DoSvc
) do (
    echo Setting %%D to disabled...
    sc config %%D start= disabled >nul 2>&1 && echo [97m[ [32mOK [97m] Disabling %%D... [39m || echo [97m[ [91mFAILED [97m] Disabling %%D...[39m
)

for %%M in (
    BFE
    AppIDSvc
    AppMgmt
    AppXSvc
    Appinfo
    Browser
    COMSysApp
    ClipSVC
    DcpSvc
    DeviceInstall
    EapHost
    GraphicsPerfSvc
    HomeGroupListener
    HomeGroupProvider
    IEEtwCollectorService
    InventorySvc
    IpxlatCfgSvc
    KtmRm
    LanmanWorkstation
    LicenseManager
    LxpSvc
    McpManagementService
    MSiSCSI 
    NaturalAuthentication
    NcaSvc
    NcdAutoSetup
    NetSetupSvc
    Netman
    NgcCtnrSvc
    NgcSvc
    NlaSvc
    PNRPsvc 
    PeerDistSvc
    PerfHost
    PlugPlay
    PolicyAgent
    PushToInstall
    QWAVE
    RasAuto
    RpcLocator
    SCPolicySvc
    SDRSVC
    Sense
    SharedRealitySvc
    SmsRouter
    StateRepository
    TimeBroker
    TimeBrokerSvc
    TroubleshootingSvc
    TrustedInstaller
    UI0Detect
    UdkUserSvc
    webthreatdefusersvc
    UmRdpService
    VacSvc  
    WEPHOSTSVC
    WFDSConMgrSvc
    WManSvc
    WSService   
    WaaSMedicSvc
    WarpJITSvc  
    WcsPlugInService
    WdNisSvc
    WiaRpc
    WpnService
    camsvc
    cloudidsvc
    dcsvc
    defragsvc
    dot3svc
    embeddedmode
    hidserv
    lltdsvc
    msiserver
    netprofm
    p2pimsvc
    p2psvc
    perceptionsimulation
    pla
    spectrum
    svsvc
    swprv
    upnphost
    vds
    vm3dservice
    vmvss
    wbengine
    webthreatdefsvc
    wlpasvc
    wmiApSrv
    workfolderssvc
    wudfsvc
) do (
    echo Setting %%M to manual...
    sc config %%M start= demand >nul 2>&1 && echo [97m[ [32mOK [97m] Setting %%M to manual... [39m || echo [97m[ [91mFAILED [97m] Setting %%M to manual... [39m
)

for %%Q in (
    sppsvc
) do (
    echo Setting %%Q to automatic [delayed]...
    sc config %%Q start= delayed-auto >nul 2>&1 && echo [97m[ [32mOK [97m] Setting %%Q to automatic-delayed... [39m || echo [97m[ [91mFAILED [97m] Setting %%Q to automatic-delayed...[39m
)



for %%A in (
    AudioEndpointBuilder
    AudioSrv
    Audiosrv
    BrokerInfrastructure
    CoreMessagingRegistrar
    CryptSvc
    DcomLaunch
    Dhcp
    Dnscache
    EventLog
    EventSystem
    gpsvc
    KeyIso
    LSM
    MpsSvc
    Power
    ProfSvc
    RpcEptMapper
    RpcSs
    SamSs
    Schedule
    SENS
    SgrmBroker
    SystemEventsBroker
    UserManager
    VGAuthService
    VMTools
    VaultSvc
    tiledatamodelsvc
    Winmgmt
) do (
    echo Setting %%A to automatic...
    sc config %%A start= auto >nul 2>&1 && echo [97m[ [32mOK [97m] Setting %%A to automatic... [39m || echo [97m[ [91mFAILED [97m] Setting %%A to automatic...[39m
)

cls
echo Applying disabled services in regedit...
for %%D in (
    BcastDVRUserService
    wlidsvc   
    wcncsvc
    DisplayEnhancementService 
    DiagTrack 
    DusmSvc 
    TabletInputService 
    Fax 
    lfsvc 
    AJRouter
    ALG
    Netlogon
    CertPropSvc
    Themes
    DPS
    AssignedAccessManagerSvc
    DialogBlockingService
    NetTcpPortSharing
    PimIndexMaintenanceSvc
    RemoteAccess
    UevAgentService
    WSearch
    VSS
    MapsBroker
    shpamsvc
    ssh-agent
    tzautoupdate
    uhssvc
    MSDTC
    SecurityHealthService
    SysMain
    WdiServiceHost
    WinDefend
    wscsvc
    wisvc
    StorSvc
    NcbService
    WdiSystemHost
    AppReadiness
    XblAuthManager
    PNRPAutoReg
    XblGameSave
    XboxGipSvc
    XboxNetApiSvc
    SCardSvr
    CscService
    WalletService
    icssvc
    fhsvc
    FrameServer
    FrameServerMonitor
    EntAppSvc
    DmEnrollmentSvc
    AxInstSV
    DeviceAssociationService
    TieringEngineService
    TextInputManagementService
    CDPSvc
    DevQueryBroker
    EFS
    FDResPub
    :: Hyper-V
    HvHost
    vmicguestinterface
    vmicheartbeat
    vmickvpexchange
    vmicrdv
    vmicshutdown
    vmictimesync
    vmicvmsession
    vmicvss
    :: Done
    IKEEXT
    InstallService
    MixedRealityOpenXRSvc
    MsKeyboardFilter
    PrintNotify
    RasMan
    RmSvc
    SensorDataService
    SensorService
    SensrSvc
    SessionEnv
    SharedAccess
    StiSvc
    TokenBroker
    UsoSvc
    W32Time
    WebClient
    Wecsvc
    WinRM
    autotimesvc
    dmwappushservice
    edgeupdate
    edgeupdatem
    fdPHost
    smphost
    wercplsupport
    wuauserv
    DispBrokerDesktopSvc
    FontCache
    LanmanServer
    TermService
    Wcmsvc
    cbdhsvc 
    WpcMonSvc 
    MicrosoftEdgeElevationService 
    edgeupdate 
    edgeupdatem 
    autotimesvc
    diagnosticshub.standardcollector.service 
    PhoneSvc 
    TapiSrv 
    WbioSrvc 
    SEMgrSvc 
    iphlpsvc 
    BthAvctpSvc 
    BDESVC 
    CDPUserSvc 
    DevicesFlowUserSvc 
    TrkWks 
    dLauncherLoopback 
    NPSMSvc 
    WPDBusEnum 
    PcaSvc 
    RetailDemo
    SSDPSRV 
    OneSyncSvc 
    UserDataSvc 
    UnistoreSvc 
    DsSvc 
    AppVClient 
    SstpSvc 
    WMPNetworkSvc 
    WerSvc  
    WinHttpAutoProxySvc 
    DsmSvc 
) do (
    echo ðŸ›ˆ Setting %%D to disabled... ^(Via Regedit^)
    reg add "HKLM\SYSTEM\CurrentControlSet\Services\%%D" /v Start /t REG_DWORD /d 4 /f >nul 2>&1
)

cls
echo Applying manual services in regedit...
for %%M in (
    BFE
    AppIDSvc
    AppMgmt
    AppXSvc
    Appinfo
    Browser
    COMSysApp
    ClipSVC
    DcpSvc
    DeviceInstall
    EapHost
    GraphicsPerfSvc
    HomeGroupListener
    HomeGroupProvider
    IEEtwCollectorService
    InventorySvc
    IpxlatCfgSvc
    KtmRm
    LanmanWorkstation
    LicenseManager
    LxpSvc
    McpManagementService
    MSiSCSI 
    NaturalAuthentication
    NcaSvc
    NcdAutoSetup
    NetSetupSvc
    Netman
    NgcCtnrSvc
    NgcSvc
    NlaSvc
    PNRPsvc 
    PeerDistSvc
    PerfHost
    PlugPlay
    PolicyAgent
    PushToInstall
    QWAVE
    RasAuto
    RpcLocator
    SCPolicySvc
    SDRSVC
    Sense
    SharedRealitySvc
    SmsRouter
    StateRepository
    TimeBroker
    TimeBrokerSvc
    TroubleshootingSvc
    TrustedInstaller
    UI0Detect
    UdkUserSvc
    webthreatdefusersvc
    UmRdpService
    VacSvc  
    WEPHOSTSVC
    WFDSConMgrSvc
    WManSvc
    WSService   
    WaaSMedicSvc
    WarpJITSvc  
    WcsPlugInService
    WdNisSvc
    WiaRpc
    WpnService
    camsvc
    cloudidsvc
    dcsvc
    defragsvc
    dot3svc
    embeddedmode
    hidserv
    lltdsvc
    msiserver
    netprofm
    p2pimsvc
    p2psvc
    perceptionsimulation
    pla
    spectrum
    svsvc
    swprv
    upnphost
    vds
    vm3dservice
    vmvss
    wbengine
    webthreatdefsvc
    wlpasvc
    wmiApSrv
    workfolderssvc
    wudfsvc
) do (
    echo ðŸ›ˆ Setting %%M to manual...
    reg add "HKLM\SYSTEM\CurrentControlSet\Services\%%M" /v Start /t REG_DWORD /d 3 /f >nul 2>&1
)
chcp 65001 >nul
echo [92mâœ“ Done.
chcp 437 >nul

:: Disable bluetooth services
cls && echo Disabling bluetooth...
for %%D in (
    BTAGService
    bthserv
) do (
    echo ðŸ›ˆ Setting %%D to disabled...
    sc config %%D start= disabled >nul 2>&1
)

:: Disable Razer services
color a
cls && echo Disabling Razer services...
for %%M in (
    RzActionSvc
    "Razer Game Manager Service"
    "Razer Synapse Service"
) do (
    echo ðŸ›ˆ Setting %%M to manual.
    sc config %%M start= demand >nul 2>&1
)

:: (PIF) Disabling windows update and store services
color 9
cls && echo Disabling Windows Update and Store services
chcp 437 >nul

for %%S in (
    ClipSVC
    uhssvc
    upfc
    PushToInstall
    BITS
    InstallService
    uhssvc
    UsoSvc
    wuauserv
    LanmanServer
) do (
    sc stop %%S >nul 2>&1 && echo [97m[ [32mOK [97m] %%S killed successfully[39m || echo [97m[ [91mFAILED [97m] Failed to stop %%S![39m
)

for %%D in (
    ClipSVC 
    BITS 
    InstallService 
    uhssvc 
    UsoSvc    
    wuauserv 
    LanmanServer 
) do (
    echo Setting %%D to disabled...
    sc config %%D start= disabled >nul 2>&1 && echo [97m[ [32mOK [97m] %%D disabled successfully[39m || echo [97m[ [91mFAILED [97m] Failed to change %%D![39m
)